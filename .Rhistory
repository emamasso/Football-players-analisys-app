collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics <- metric_set(accuracy, spec, sens, f_meas)
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
third_off_recipe_trial <- recipe(off_cluster ~ defensive_score.y +  Min.x + offensive_score.x + gk_score.y + GA.y,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
third_off_recipe_trial <- recipe(off_cluster ~ defensive_score.y +  Min.x + offensive_score.x + gk_score.y + GA.y,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
logistic_preds %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 43)
logistic_preds %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
print(n = 43)
43/2446
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
third_off_recipe <- recipe(off_cluster ~ offensive_score.y + score.y +
passing_score.y + possession_score.y,
data = training(third_split)) %>%
step_upsample(off_cluster)
logistic_workflow <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe)
logistic_third_fit <- logistic_workflow %>%
last_fit(split = third_split)
logistic_preds <- logistic_third_fit %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics <- metric_set(accuracy, spec, sens, f_meas)
custom_metrics(logistic_preds,
truth = off_cluster,
estimate = .pred_class)
logistic_preds %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1)
logistic_preds %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
print(n =1000)
third_off_recipe_trial <- recipe(off_cluster ~ defensive_score.y + gk_score.y + GA.y,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
third_off_recipe_trial <- recipe(off_cluster ~ defensive_score.y + gk_score.y + GA.y,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
third_off_recipe_trial <- recipe(off_cluster ~ defensive_score.y + offensive_score.x + gk_score.y + GA.y,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics <- metric_set(accuracy, spec, sens, f_meas)
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
logistic_preds %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0)
logistic_preds %>%
group_by(Player) %>%
summarise(prop_cluster1 = mean(.pred_class == 1)) %>%
ggplot(aes(x = reorder(Player, prop_cluster1), y = prop_cluster1)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Propensione al cluster offensivo predetto", y = "Frequenza cluster 1", x = "Giocatore")
logistic_preds %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0) %>%
print(n = 1000)
logistic_preds %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0) %>%
print(n = 100)
logistic_preds %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0)
logistic_preds %>%
group_by(Player) %>%
summarise(pred_range = max(.pred_1) - min(.pred_1)) %>%
summary()
logistic_preds
logistic_preds %>%
group_by(Player) %>%
summarise(pred_range = max(.pred_Offensivly passive) - min(.pred_Offensivly passive)) %>%
logistic_preds %>%
group_by(Player) %>%
summarise(pred_range = max(.pred_Offensivly_passive) - min(.pred_Offensivly_passive)) %>%
summary()
logistic_preds %>%
group_by(Player) %>%
summarise(pred_range = max(`.pred_Offensivly passive`) - min(`.pred_Offensivly passive`)) %>%
summary()
ggplot(logistic_preds, aes(x = .pred_1)) +
geom_histogram(bins = 50, fill = "steelblue") +
labs(title = "Distribuzione delle probabilità predette per il cluster 1")
ggplot(logistic_preds, aes(x = `.pred_Offensivly passive`)) +
geom_histogram(bins = 50, fill = "steelblue") +
labs(title = "Distribuzione delle probabilità predette per il cluster 1")
third_off_recipe_trial <- recipe(off_cluster ~ offensive_score.x + defensive_score.y + gk_score.y + GA.y,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics <- metric_set(accuracy, spec, sens, f_meas)
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
third_off_recipe_trial <- recipe(off_cluster ~  defensive_score.y + gk_score.y + GA.y,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
logistic_preds_trial %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(prop_cluster1 = mean(.pred_class == 1)) %>%
ggplot(aes(x = reorder(Player, prop_cluster1), y = prop_cluster1)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Propensione al cluster offensivo predetto", y = "Frequenza cluster 1", x = "Giocatore")
logistic_preds_trial %>%
group_by(Player) %>%
summarise(pred_range = max(`.pred_Offensivly passive`) - min(`.pred_Offensivly passive`)) %>%
summary()
ggplot(logistic_preds_trial, aes(x = `.pred_Offensivly passive`)) +
geom_histogram(bins = 50, fill = "steelblue") +
labs(title = "Distribuzione delle probabilità predette per il cluster 1")
third_off_recipe_trial <- recipe(off_cluster ~  .,
data = training(third_split)) %>%
step_downsample(off_cluster)
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
table(training(third_split)$off_cluster)
third_off_recipe_trial <- recipe(off_cluster ~  .,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
third_off_recipe_trial <- recipe(offensive_score.x ~  .,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
names(player_vs_team)
third_off_recipe_trial <- recipe(off_cluster ~  offensive_score.x + Blocks_stats_defense.y + Int.y + Tkl.Int.y +
Clr.y  + Err.y + GA.y + Saves.y,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
logistic_preds_trial %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(prop_cluster1 = mean(.pred_class == 1)) %>%
ggplot(aes(x = reorder(Player, prop_cluster1), y = prop_cluster1)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Propensione al cluster offensivo predetto", y = "Frequenza cluster 1", x = "Giocatore")
logistic_preds_trial %>%
group_by(Player) %>%
summarise(pred_range = max(`.pred_Offensivly passive`) - min(`.pred_Offensivly passive`)) %>%
summary()
ggplot(logistic_preds_trial, aes(x = `.pred_Offensivly passive`)) +
geom_histogram(bins = 50, fill = "steelblue") +
labs(title = "Distribuzione delle probabilità predette per il cluster 1")
third_off_recipe_trial <- recipe(off_cluster ~  Blocks_stats_defense.y + Int.y + Tkl.Int.y +
Clr.y  + Err.y + GA.y + Saves.y,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
logistic_preds_trial %>%
count(Player, .pred_class) %>%
group_by(Player) %>%
mutate(perc = n / sum(n)) %>%
pivot_wider(names_from = .pred_class, values_from = perc, values_fill = 0)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(prop_cluster1 = mean(.pred_class == 1)) %>%
ggplot(aes(x = reorder(Player, prop_cluster1), y = prop_cluster1)) +
geom_col(fill = "steelblue") +
coord_flip() +
labs(title = "Propensione al cluster offensivo predetto", y = "Frequenza cluster 1", x = "Giocatore")
logistic_preds_trial %>%
group_by(Player) %>%
summarise(pred_range = max(`.pred_Offensivly passive`) - min(`.pred_Offensivly passive`)) %>%
summary()
third_off_recipe_trial <- recipe(off_cluster ~  defensive_score.y + Blocks_stats_defense.y + Int.y + Tkl.Int.y +
Clr.y  + Err.y + GA.y + Saves.y,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
third_off_recipe_trial <- recipe(off_cluster ~  defensive_score.y + GA.y + Saves.y,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics <- metric_set(accuracy, spec, sens, f_meas)
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
third_off_recipe_trial <- recipe(off_cluster ~ gk_score.y defensive_score.y + Gls.x + Ast.x,
third_off_recipe_trial <- recipe(off_cluster ~ gk_score.y + defensive_score.y + Gls.x + Ast.x,
data = training(third_split))
logistic_workflow_trial <- workflow() %>%
add_model(logistic_model) %>%
add_recipe(third_off_recipe_trial)
logistic_third_fit_trial <- logistic_workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <- logistic_third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
custom_metrics <- metric_set(accuracy, spec, sens, f_meas)
custom_metrics(logistic_preds_trial,
truth = off_cluster,
estimate = .pred_class)
logistic_preds_trial %>%
group_by(Player) %>%
summarise(cluster_variability = n_distinct(.pred_class)) %>%
filter(cluster_variability > 1) %>%
print(n = 100)
third_off_recipe_trial <- recipe(offensive_score ~ gk_score.y + defensive_score.y + Gls.x + Ast.x,
data = training(third_split))
third_off_recipe_trial <- recipe(offensive_score.x ~ gk_score.y + defensive_score.y + Gls.x + Ast.x,
data = training(third_split))
workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
third_fit_trial <- workflow_trial %>%
last_fit(split = third_split)
logistic_preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
tidy(third_fit_trial)
third_fit_trial
preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
metrics(preds_trial, truth = offensive_score.x, estimate = .pred)
tidy(third_fit_trial)
model_fit <- extract_fit_parsnip(third_fit_trial)
tidy(model_fit)
third_off_recipe_trial <- recipe(offensive_score.x ~  Tkl.y + TklW.y + Blocks_stats_defense.y +
Int.y + Clr.y +Err.y + GA.y + Saves.y +
Gls.x + Ast.x,
data = training(third_split))
workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
third_fit_trial <- workflow_trial %>%
last_fit(split = third_split)
preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
model_fit <- extract_fit_parsnip(third_fit_trial)
tidy(model_fit)
metrics(preds_trial, truth = offensive_score.x, estimate = .pred)
third_off_recipe_trial <- recipe(offensive_score.x ~  Tkl.y + TklW.y + Blocks_stats_defense.y +
Int.y + Clr.y +Err.y + GA.y + Saves.y,
data = training(third_split))
workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
third_fit_trial <- workflow_trial %>%
last_fit(split = third_split)
preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
model_fit <- extract_fit_parsnip(third_fit_trial)
tidy(model_fit)
third_off_recipe_trial <- recipe(Gls.x ~ offensive_score.x +
Tkl.y + TklW.y + Blocks_stats_defense.y +
Int.y + Clr.y +Err.y + GA.y + Saves.y,
data = training(third_split))
workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
third_fit_trial <- workflow_trial %>%
last_fit(split = third_split)
preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
model_fit <- extract_fit_parsnip(third_fit_trial)
tidy(model_fit)
metrics(preds_trial, truth = offensive_score.x, estimate = .pred)
metrics(preds_trial, truth = Gls.x, estimate = .pred)
third_off_recipe_trial <- recipe(Gls.x ~ offensive_score.x + score.x
Tkl.y + TklW.y + Blocks_stats_defense.y +
third_off_recipe_trial <- recipe(Gls.x ~ offensive_score.x + score.x +
Tkl.y + TklW.y + Blocks_stats_defense.y +
Int.y + Clr.y +Err.y + GA.y + Saves.y,
data = training(third_split))
workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
third_fit_trial <- workflow_trial %>%
last_fit(split = third_split)
preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
model_fit <- extract_fit_parsnip(third_fit_trial)
tidy(model_fit)
metrics(preds_trial, truth = Gls.x, estimate = .pred)
third_off_recipe_trial <- recipe(score.x ~ offensive_score.x  + passing_score.x + possession_score.x +
Tkl.y + TklW.y + Blocks_stats_defense.y +
Int.y + Clr.y +Err.y + GA.y + Saves.y,
data = training(third_split))
workflow_trial <- workflow() %>%
add_model(linear_model) %>%
add_recipe(third_off_recipe_trial)
third_fit_trial <- workflow_trial %>%
last_fit(split = third_split)
preds_trial <-third_fit_trial %>%
collect_predictions() %>%
bind_cols(third_test %>%
select(Player))
model_fit <- extract_fit_parsnip(third_fit_trial)
tidy(model_fit)
metrics(preds_trial, truth = Gls.x, estimate = .pred)
metrics(preds_trial, truth = score.x, estimate = .pred)
